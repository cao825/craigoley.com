!function(e){e.fn.coTable=function(t){function r(e){b.alternateRows&&a(e)}function a(t){var r=e("table#"+t);if(r.hasClass("table-striped")){var a=0;e("table#"+t+" tbody tr:visible").each(function(){a%2===1?e(this).css("background-color",u):e(this).css("background-color",v),a++})}else r.addClass("table-striped")}function o(t,a,o,n){var i=new Array;e("table#"+t+" tbody tr td:nth-child("+o+")").each(function(){var t=e(this);i.push({elem:t,data:s(t.html())})}),i=c(i,n);a.empty();for(var l=0;l<i.length;l++)a.append(i[l].elem.parent().clone());r(t)}function s(e){return e.replace(" ","")==parseInt(e.replace(" ",""))?parseInt(e.replace(" ","")):e.replace(" ","").replace(",","")==parseFloat(e.replace(" ","").replace(",",""))?parseFloat(e.replace(" ","").replace(",","")):e.toLowerCase()}function c(e,t){if(0===e.length)return[];for(var r=new Array,a=new Array,o=e[0],s=1;s<e.length;s++)"asc"===t?e[s].data<o.data?r.push(e[s]):a.push(e[s]):e[s].data>o.data?r.push(e[s]):a.push(e[s]);return c(r,t).concat(o,c(a,t))}function n(t){m=t,b.showTableInfo&&e("#"+h+"_coTableInfo_rowCount").html(m)}function i(){var t=e("table#"+h+" tbody tr").length,r=e("table#"+h+" tbody tr.coTableHidden").length,a=t-r;return a}function l(e){return e=e.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i),e&&4===e.length?"#"+("0"+parseInt(e[1],10).toString(16)).slice(-2)+("0"+parseInt(e[2],10).toString(16)).slice(-2)+("0"+parseInt(e[3],10).toString(16)).slice(-2):""}var d=e(this),h=d.attr("id"),f=e("table#"+h+" tbody"),p=e("table#"+h+" thead"),u=l(e("table#"+h).css("background-color")),v=l(e("table#"+h+" tbody tr:first").css("background-color")),b=e.extend({filterable:!0,filter_case_sensitive:!0,sortable:!0,exportable:!0,exportFileName:"",exportIcon:"",showTableInfo:!0,alternateRows:!0,highlightHoverRow:!0,imgPath:"/css/coTableImg/"},t);if(!d.hasClass("coTable")){("undefined"==typeof h||null===h||""===h)&&(h="coTable"+Math.floor(65536*(1+Math.random())).toString(16).substring(1),d.attr("id",h)),"/"!==b.imgPath.slice(-1)&&(b.imgPath=b.imgPath+"/");var g=0,m=i(),S=new Array;if(d.addClass("coTable"),b.sortable)var T="<div class='coSortHeaderBoth' style='float: right'><img src='"+b.imgPath+"sort_both.png' height='15' /></div><br class='coSortHeaderBreak' /><div class='coClear'></div><div class='coSortSpinner coSortHidden'>Sorting...</div>";if(d.find("th").each(function(){var t=e(this);!t.hasClass("coSortHeader")&&b.sortable&&(t.addClass("coSortHeader"),t.html("<div class='coSortWrapper'><div class='coSortContent'>"+t.html()+"&emsp;</div>"+T+"</div>"));var r=t.attr("id");("undefined"==typeof curr_id||null===curr_id||""===curr_id)&&(r="coTable"+g,t.attr("id",r)),S.push({id:r,width:t.width()}),g++}),b.filterable){for(var w="<tr class='coFilters coNoExport' id='"+h+"_coFilters'>",H=0;g>H;H++){var C=Math.round(S[H].width/10);w=w+"<th class='coFilter' id='"+h+"_coFilterCell_"+H+"'><input size='"+C+"' class='coFilterInput form-control text-box single-line' name='coFilter_"+H+"' id='"+h+"_coFilter_"+H+"' type='text' /></th>"}w+="</tr>",p.append(w)}if(b.exportable&&(b.showTableInfo=!0,""!=b.exportFileName&&d.attr("coTableExportFileName",b.exportFileName)),b.showTableInfo){var x="<tr class='coTableInfo' id='"+h+"_coTableInfo'><th colspan='"+g+"' class='coNoExport'>";if(b.exportable){var y;y=""!=b.exportIcon?"<img src='"+b.exportIcon+"' />":"<i class='fa fa-file-excel-o'></i>",x=x+"<a href='javascript:void(0)' onclick='$(\"table#"+h+'").coTableExport('+JSON.stringify(t)+");' class='coHoverImage'></a>&ensp;"}x=x+"Row Count: <span id='"+h+"_coTableInfo_rowCount'>"+m+"</span></th></tr>",p.append(x),n(i())}b.highlightHoverRow&&e("table#"+h).addClass("table-hover")}return r(h),e(".coFilterInput").keyup(function(){return e(this).closest("table").find("tr").each(function(){e(this).removeClass("coTableToHide").addClass("coTableToShow")}),e(".coFilterInput").each(function(){var t=e(this);if(t.val()){var r=t.parent(),a=r.index()+1,o=t.val();r.closest("table").find("td:nth-child("+a+")").each(function(){var t=e(this),r=t.parent();""==o||t.hasClass("coFilter")||-1!==t.text().search(o)||r.addClass("coTableToHide").removeClass("coTableToShow")})}return this}),e(".coTableToHide").each(function(){var t=e(this);return t.addClass("coTableHidden").removeClass("coTableToHide").removeClass("coTableToShow"),this}),e(".coTableToShow").each(function(){return e(this).removeClass("coTableHidden").removeClass("coTableToShow"),this}),n(i()),r(h),this}),e(".coSortHeader").click(function(){var t=e(this);return e(".coSortHeaderBoth").remove(),d.find("th").each(function(){var r=e(this);r.attr("id")!=t.attr("id")&&r.find(".coSortHeaderBreak").before("<div class='coSortHeaderBoth' style='float:right'><img src='"+b.imgPath+"sort_both.png' height='15' /></div>")}),e("#"+h+"_coSortHeaderImg").remove(),t.find(".coSortContent").hide(),t.find(".coSortSpinner").show(function(){t.hasClass("coAscHeader")?(e(".coSortHeader").removeClass("coAscHeader"),e(".coSortHeader").removeClass("coDescHeader"),t.addClass("coDescHeader"),o(h,f,t.index()+1,"desc"),t.find(".coSortHeaderBreak").before("<div id='"+h+"_coSortHeaderImg' style='float:right'><img src='"+b.imgPath+"sort_desc.png' height='15' /></div>")):t.hasClass("coDescHeader")?(e(".coSortHeader").removeClass("coAscHeader"),e(".coSortHeader").removeClass("coDescHeader"),t.addClass("coAscHeader"),o(h,f,t.index()+1,"asc"),t.find(".coSortHeaderBreak").before("<div id='"+h+"_coSortHeaderImg' style='float:right'><img src='"+b.imgPath+"sort_asc.png' height='15' /></div>")):(e(".coSortHeader").removeClass("coAscHeader"),e(".coSortHeader").removeClass("coDescHeader"),t.addClass("coAscHeader"),o(h,f,t.index()+1,"asc"),t.find(".coSortHeaderBreak").before("<div id='"+h+"_coSortHeaderImg' style='float:right'><img src='"+b.imgPath+"sort_asc.png' height='15' /></div>")),t.find(".coSortSpinner").hide(),t.find(".coSortSpinner").addClass("coSortHidden"),t.find(".coSortContent").show()}),this}),e(this)},e.fn.coTableExport=function(){function t(t){t="#"+t;var r=new Array,a=0,o=[],s=[],n=[];e("table"+t+" thead tr th").each(function(){var t=e(this);if(!t.hasClass("coNoExport")){var s=t.attr("rowspan"),c=t.attr("colspan");r[a]=t.text().replace("Sorting...","");var i=r[a];o.forEach(function(e){if(l>=e.s.r&&l<=e.e.r&&n.length>=e.s.c&&n.length<=e.e.c)for(var t=0;t<=e.e.c-e.s.c;++t)n.push(null)}),(s||c)&&(s=s||1,c=c||1,o.push({s:{r:l,c:n.length},e:{r:l+s-1,c:n.length+c-1}})),n.push(""!==i?i:null),a++}}),s.push(n);var i=new Array,l=0,d=0,h=e(t+" tbody"),f=h.html(),p=/<br\s*[\/]?>/gi;h.html(f.replace(p," ~EL~ ")),e(t+" tbody tr:visible").each(function(){var t=e(this);n=[],t.hasClass("coNoExport")||(i[l]=new Array,d=0,t.children("td").each(function(){var t=e(this),r=t.attr("rowspan"),a=t.attr("colspan");i[l][d]=c(t),i[l][d].replace(" ","").replace(",","")==parseFloat(i[l][d].replace(" ","").replace(",",""))&&(i[l][d]=i[l][d].replace(" ","").replace(",",""));var s=i[l][d];if(o.forEach(function(e){if(l>=e.s.r&&l<=e.e.r&&n.length>=e.s.c&&n.length<=e.e.c)for(var t=0;t<=e.e.c-e.s.c;++t)n.push(null)}),(r||a)&&(r=r||1,a=a||1,o.push({s:{r:l,c:n.length},e:{r:l+r-1,c:n.length+a-1}})),n.push(""!==s?s:null),a)for(var h=0;a-1>h;++h)n.push(null);d++}),s.push(n),l++)}),h.html(f);var u=new Object;u.header=r,u.details=i;JSON.stringify(u);return[s,o]}function r(e,t){t&&(e+=1462);var r=Date.parse(e);return(r-new Date(Date.UTC(1899,11,30)))/864e5}function a(e){for(var t={},a={s:{c:1e7,r:1e7},e:{c:0,r:0}},o=0;o!=e.length;++o)for(var s=0;s!=e[o].length;++s){a.s.r>o&&(a.s.r=o),a.s.c>s&&(a.s.c=s),a.e.r<o&&(a.e.r=o),a.e.c<s&&(a.e.c=s);var c={v:e[o][s]};if(null!=c.v){var n=XLSX.utils.encode_cell({c:s,r:o});"number"==typeof c.v?c.t="n":"boolean"==typeof c.v?c.t="b":c.v instanceof Date?(c.t="n",c.z=XLSX.SSF._table[14],c.v=r(c.v)):c.t="s",t[n]=c}}return a.s.c<1e7&&(t["!ref"]=XLSX.utils.encode_range(a)),t}function o(){return this instanceof o?(this.SheetNames=[],void(this.Sheets={})):new o}function s(e){for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),a=0;a!=e.length;++a)r[a]=255&e.charCodeAt(a);return t}function c(t){var r="",a=t.get(0).tagName;switch(a){case"INPUT":return"checkbox"===t.attr("type")?t.attr("checked")?" "+t.val():"":" "+t.val();case"SELECT":return" "+t.children(":selected").text();case"TEXTAREA":return" "+t.val();case"IMG":return t.attr("alt");case"A":return"";default:var o=t.children(":visible");return o.length>0?(o.each(function(){var t=e(this);t.is("br")?r+=" ~EL~ ":t.is(":visible")&&(r=r+" "+c(t))})," "+r):" "+t.text()}}var n=e(this),i=n.attr("id");e("#coLoadWrapper").show("fast",function(){setTimeout(function(){var r=e("#"+i),c="";c=r.attr("coTableExportFileName")?r.attr("coTableExportFileName")+"_"+Date.now():"coTableExport_"+Date.now();var l=t(i),d=l[1],h=l[0],f=new o,p=a(h);p["!merges"]=d,f.SheetNames.push(c),f.Sheets[c]=p;var u=XLSX.write(f,{bookType:"xlsx",bookSST:!1,type:"binary"});return saveAs(new Blob([s(u)],{type:"application/octet-stream"}),c+".xlsx"),e("#coLoadWrapper").hide(),n},1)})}}(jQuery),Date.now||(Date.now=function(){return(new Date).getTime()});